<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,height=device-height,initial-scale=1,minimum-scale=1"><meta name=robots content="noodp"><title>Azure Enterprise Agreement Delegation - Incredible Technology, Incredibly Simple</title><meta name=Description content><meta property="og:url" content="https://damianflynn.github.io/posts/azure-enterprise-agreement-delegation/"><meta property="og:site_name" content="Incredible Technology, Incredibly Simple"><meta property="og:title" content="Azure Enterprise Agreement Delegation"><meta property="og:description" content="Delegating Azure Enterprise Agreement Owner privileges to a Service Principal (SPN)
Under the Enterprise agreement we have some different Personaâ€™s, which have quite different abilities and operations upon which they are permitted to preform.
Before we being the process of delegation, It is important to understand this Hierarchy, so we can correctly proceed with the technical work ahead.
Enterprise Administrator Has the ability to add additional Enterprise and Department Administrators, Additional this persona can"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-04-24T00:00:00+00:00"><meta property="article:modified_time" content="2024-07-19T15:22:00+00:00"><meta property="article:tag" content="Identity"><meta property="og:image" content="https://damianflynn.github.io/posts/azure-enterprise-agreement-delegation/cover-b0769a29.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://damianflynn.github.io/posts/azure-enterprise-agreement-delegation/cover-b0769a29.jpg"><meta name=twitter:title content="Azure Enterprise Agreement Delegation"><meta name=twitter:description content="Delegating Azure Enterprise Agreement Owner privileges to a Service Principal (SPN)
Under the Enterprise agreement we have some different Personaâ€™s, which have quite different abilities and operations upon which they are permitted to preform.
Before we being the process of delegation, It is important to understand this Hierarchy, so we can correctly proceed with the technical work ahead.
Enterprise Administrator Has the ability to add additional Enterprise and Department Administrators, Additional this persona can"><meta name=twitter:site content="@damian_flynn"><meta name=application-name content="TechSimplified"><meta name=apple-mobile-web-app-title content="TechSimplified"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><meta name=twitter:creator content="@damian_flynn"><link rel="shortcut icon" type=image/x-icon href=/favicons/img-favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicons/img-favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicons/img-favicon-16x16.png><link rel=icon type=image/png sizes=192x192 href=/favicons/img-android-chrome-192x192.png><link rel=icon type=image/png sizes=512x512 href=/favicons/img-android-chrome-512x512.png><link rel=apple-touch-icon sizes=180x180 href=/favicons/img-apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://damianflynn.github.io/posts/azure-enterprise-agreement-delegation/><link rel=prev href=https://damianflynn.github.io/posts/azure-iac-function-keys/><link rel=next href=https://damianflynn.github.io/posts/change-detection-using-oxidized/><link rel=stylesheet href=/css/css-styles.min.css><link rel=stylesheet href=/css/n8n-chat.min.css><script type=module>
	import { createChat } from 'https://cdn.jsdelivr.net/npm/@n8n/chat/dist/chat.bundle.es.js';

	createChat({
		webhookUrl: 'https://n8n.deercrest.info/webhook/b76d02c0-b406-4d21-b6bf-8ad2c623def3/chat',
    initialMessages: [
      'Hi there! ðŸ‘‹',
      'My name is Nathan. How can I assist you today?'
    ],
    i18n: {
      en: {
        title: 'Search ðŸ”Ž & Chat! ðŸ‘‹',
        subtitle: "Start a chat. We're here to help you 24/7.",
        footer: '',
        getStarted: 'New Conversation',
        inputPlaceholder: 'Type your question..',
      },
    },
    showWelcomeScreen: false,
	  defaultLanguage: 'en'
	});
</script><script src=/js/alpinejs.js defer></script><style>[x-cloak]{display:none!important}</style><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Azure Enterprise Agreement Delegation","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https://damianflynn.github.io/posts/azure-enterprise-agreement-delegation/"},"image":["https://damianflynn.github.io/cover-b0769a29.jpg"],"genre":"posts","keywords":["Identity"],"wordcount":1492,"url":"https://damianflynn.github.io/posts/azure-enterprise-agreement-delegation/","datePublished":"2020-04-24T00:00:00+00:00","dateModified":"2024-07-19T15:22:00+00:00","publisher":{"@type":"Organization","name":"xxxx","logo":{"@type":"ImageObject","url":"https://damianflynn.github.io/images/avatar.webp","width":400,"height":400}},"author":{"@type":"Person","name":"Author","url":"/"},"description":""}</script></head><body data-instant-intensity=viewport class="bg-white font-sans tracking-wide text-base text-gray-700 print:text-black font-medium break-words hyphens antialiased flex flex-col min-h-screen ta-page-scrolling"><div role=navigation class="absolute inset-x-0 top-0 z-10 w-full text-center h-16 sm:h-20 lg:h-24 xl:h-28" x-data=taNavigation><a href=/ class="absolute left-0 top-0 h-full flex-center w-16 sm:w-20 lg:w-24 xl:w-28 p-3 sm:p-4 lg:p-5 xl:p-6 bg-secondary-500"><span class=sr-only>To the home page</span>
<img src=/images/img-logo-damian-flynn-white.svg alt="Logo Damian Flynn" class=w-full></a><div class="absolute lg:hidden right-0 top-0 text-white w-16 h-16 sm:w-20 sm:h-20 p-3 sm:p-4"><svg class="w-full h-full" viewbox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4A1 1 0 013 5zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/></svg></div><div class="hidden lg:flex items-center justify-between w-full h-full max-w-screen-2xl mx-auto px-40"><div class="flex h-full text-base font-semibold uppercase"><div class="relative flex-center text-primary-500 px-4"><a class=menu-item href=/>Home</a></div><div class="relative flex-center text-primary-500 px-4"><a class=menu-item href=/posts/>Articles</a></div><div class="relative flex-center text-primary-500 px-4"><a class=menu-item href=/series/>Topics</a></div><div class="relative flex-center text-primary-500 px-4"><a class=menu-item href=/about/>About</a></div></div><div class="flex items-center -mr-2 xl:-mr-4"><a href=https://www.youtube.com/channel/UCC-9OqE4nfLxDf-TonKqIRw/ class="block text-primary-500 h-6 w-6 mx-2 xl:mx-4 drop-shadow-sharp" target=_blank title="Opens in new Window"><span class=sr-only>Youtube </span><svg class="w-full h-full" fill="currentcolor" viewbox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
</a><a href=https://github.com/damianflynn class="block text-primary-500 h-6 w-6 mx-2 xl:mx-4 drop-shadow-sharp" target=_blank title="Opens in new Window"><span class=sr-only>GitHub </span><svg class="w-full h-full" fill="currentcolor" viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8.0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8.0-21.5 4.9-32.3 14.6-51.8 45.3.0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8.0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9.0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2.0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8.0-73.5 38.7-73.5 82.6.0 87.8 80.4 101.3 150.4 101.3h48.2c70.3.0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8.0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
</a><a href=https://www.x.com/damian_flynn class="block text-primary-500 h-6 w-6 mx-2 xl:mx-4 drop-shadow-sharp" target=_blank title="Opens in new Window"><span class=sr-only>X </span><svg class="w-full h-full" fill="currentcolor" viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</a><a href=https://www.linkedin.com/in/damianflynn class="block text-primary-500 h-6 w-6 mx-2 xl:mx-4 drop-shadow-sharp" target=_blank title="Opens in new Window"><span class=sr-only>Linkedin</span>
<svg class="w-full h-full" fill="currentcolor" viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></a></div></div><div class="fixed lg:hidden inset-0 backdrop-filter backdrop-blur-sm bg-gray-900 bg-opacity-75 z-50" x-show=modal x-transition.opacity.duration.500ms></div><div class="ta-navigation-modal fixed lg:hidden inset-y-0 right-0 w-10/12 sm:w-2/3 bg-white pt-32 z-50" x-ref=modal><div class="absolute top-0 right-0 text-primary-500 w-16 h-16 p-2"><svg class="w-full h-full" viewbox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414.0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/></svg></div><div class="flex flex-col justify-between text-left text-3xl h-full ml-12"><div class="flex flex-col"><div class="font-semibold text-primary-500 p-2 sm:my-2"><a href=/>Home</a></div><div class="font-semibold text-primary-500 p-2 sm:my-2"><a href=/posts/>Articles</a></div><div class="font-semibold text-primary-500 p-2 sm:my-2"><a href=/series/>Topics</a></div><div class="font-semibold text-primary-500 p-2 sm:my-2"><a href=/about/>About</a></div></div><div class="flex flex-wrap mb-12"><a href=https://www.youtube.com/channel/UCC-9OqE4nfLxDf-TonKqIRw/ class="block text-primary-500 h-8 w-8 mx-4 sm:mx-6" target=_blank title="Opens in new Window"><span class=sr-only>Youtube </span><svg class="w-full h-full" fill="currentcolor" viewbox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
</a><a href=https://github.com/damianflynn class="block text-primary-500 h-8 w-8 mx-4 sm:mx-6" target=_blank title="Opens in new Window"><span class=sr-only>GitHub </span><svg class="w-full h-full" fill="currentcolor" viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8.0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8.0-21.5 4.9-32.3 14.6-51.8 45.3.0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8.0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9.0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2.0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8.0-73.5 38.7-73.5 82.6.0 87.8 80.4 101.3 150.4 101.3h48.2c70.3.0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8.0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
</a><a href=https://www.x.com/damian_flynn class="block text-primary-500 h-8 w-8 mx-4 sm:mx-6" target=_blank title="Opens in new Window"><span class=sr-only>X </span><svg class="w-full h-full" fill="currentcolor" viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</a><a href=https://www.linkedin.com/in/damianflynn class="block text-primary-500 h-8 w-8 mx-4 sm:mx-6" target=_blank title="Opens in new Window"><span class=sr-only>Linkedin</span>
<svg class="w-full h-full" fill="currentcolor" viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></a></div></div></div><div class="ta-navigation-scroll top-0 inset-x-0 z-40" x-ref=scroll><div class="flex justify-between items-center lg:hidden"><a href=/index.html class="flex-center w-16 sm:w-20 p-3 sm:p-4 h-16 sm:h-20 bg-secondary-500"><span class=sr-only>To the home page</span>
<img src=/images/img-logo-damian-flynn-white.svg alt="Logo Damian Flynn" class=w-full></a><div class="flex-shrink-0 text-primary-500 w-16 h-16 p-3"><svg class="w-full h-full" viewbox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4A1 1 0 013 5zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/></svg></div></div><div class="relative hidden lg:flex justify-between items-center h-20"><a href=/index.html class="absolute top-0 left-0 flex-center w-20 h-20 p-4 bg-secondary-500"><span class=sr-only>To the home page</span>
<img src=/images/img-logo-damian-flynn-white.svg alt="Logo Damian Flynn" class=w-full></a><div class="flex items-center justify-between max-w-screen-2xl w-full h-full mx-auto px-40"><div class="flex h-full text-base font-semibold uppercase -ml-4"><div class="relative flex-center font-semibold text-primary-500 p-2 sm:my-2"><a class=menu-item href=/>Home</a></div><div class="relative flex-center font-semibold text-primary-500 p-2 sm:my-2"><a class=menu-item href=/posts/>Articles</a></div><div class="relative flex-center font-semibold text-primary-500 p-2 sm:my-2"><a class=menu-item href=/series/>Topics</a></div><div class="relative flex-center font-semibold text-primary-500 p-2 sm:my-2"><a class=menu-item href=/about/>About</a></div></div><div class="flex items-center -mr-2 xl:-mr-4"><a href=https://www.youtube.com/channel/UCC-9OqE4nfLxDf-TonKqIRw/ class="block text-primary-500 h-6 w-6 mx-2 xl:mx-4" target=_blank title="Opens in new Window"><span class=sr-only>Youtube </span><svg class="w-full h-full" fill="currentcolor" viewbox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
</a><a href=https://github.com/damianflynn class="block text-primary-500 h-6 w-6 mx-2 xl:mx-4" target=_blank title="Opens in new Window"><span class=sr-only>GitHub </span><svg class="w-full h-full" fill="currentcolor" viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8.0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8.0-21.5 4.9-32.3 14.6-51.8 45.3.0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8.0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9.0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2.0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8.0-73.5 38.7-73.5 82.6.0 87.8 80.4 101.3 150.4 101.3h48.2c70.3.0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8.0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
</a><a href=https://www.x.com/damian_flynn class="block text-primary-500 h-6 w-6 mx-2 xl:mx-4" target=_blank title="Opens in new Window"><span class=sr-only>X </span><svg class="w-full h-full" fill="currentcolor" viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</a><a href=https://www.linkedin.com/in/damianflynn class="block text-primary-500 h-6 w-6 mx-2 xl:mx-4" target=_blank title="Opens in new Window"><span class=sr-only>Linkedin</span>
<svg class="w-full h-full" fill="currentcolor" viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></a></div></div></div><div class="absolute inset-0 bg-white bg-opacity-90 shadow-lg backdrop-filter backdrop-blur-xs -z-1"></div></div></div><main role=main class="flex-grow-1 full"><div class="relative bg-gradient-article pt-16 sm:pt-20 lg:pt-24 xl:pt-28 isolate"><div class="absolute inset-x-0 -bottom-72 h-96"><div class="w-full h-full flex-center overflow-hidden"><img src=/images/img-exclude-white.svg alt class="w-full h-full min-w-[768px]"></div></div><div class="flex flex-col-reverse lg:flex-row justify-between w-full max-w-screen-2xl mx-auto text-secondary-500 px-12 lg:pl-40 xl:pr-0 pt-12 xl:pt-16 pb-16 isolate"><div class="max-w-2xl lg:mr-12 break-hyphen"><nav aria-label=breadcrumb><ol class="flex flex-wrap items-center text-sm leading-none font-bold mb-4 sm:mb-2"><li class=pr-1><a href=/index.html class="flex items-center text-primary-500 py-1"><div class="h-5 w-5"><svg class="w-full h-full" fill="currentcolor" viewbox="0 0 576 512"><path d="M280.37 148.26 96 300.11V464a16 16 0 0016 16l112.06-.29a16 16 0 0015.92-16V368a16 16 0 0116-16h64a16 16 0 0116 16v95.64a16 16 0 0016 16.05L464 480a16 16 0 0016-16V3e2L295.67 148.26a12.19 12.19.0 00-15.3.0zM571.6 251.47 488 182.56V44.05a12 12 0 00-12-12h-56a12 12 0 00-12 12v72.61L318.47 43a48 48 0 00-61 0L4.34 251.47a12 12 0 00-1.6 16.9l25.5 31A12 12 0 0045.15 301l235.22-193.74a12.19 12.19.0 0115.3.0L530.9 301a12 12 0 0016.9-1.6l25.5-31a12 12 0 00-1.7-16.93z"/></svg></div><span class=ml-2>Home</span></a></li><li class="flex items-center"><div class="h-4 w-4"><svg class="w-full h-full" fill="currentcolor" viewbox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="m15 0h525.355a15 15 0 0115 15v38.555a15 15 0 01-15 15H15a15 15 0 01-15-15V15A15 15 0 0115 0z" transform="matrix(-.5 .8660254 -.8660254 -.5 424.048 32.277)"/></svg></div><a href=/posts class="flex items-center text-primary-500 px-1 py-1">Articles</a></li><li class="flex items-center text-secondary-500"><div class="h-4 w-4"><svg class="w-full h-full" fill="currentcolor" viewbox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="m15 0h525.355a15 15 0 0115 15v38.555a15 15 0 01-15 15H15a15 15 0 01-15-15V15A15 15 0 0115 0z" transform="matrix(-.5 .8660254 -.8660254 -.5 424.048 32.277)"/></svg></div><span class="px-1 py-1">Azure Enterprise Agreement Delegation</span></li></ol></nav><div class="text-6xl leading-none font-bold mb-2">Azure Enterprise Agreement Delegation</div><div class="text-2xl leading-snug mb-4"><p>Delegating Azure Enterprise Agreement Owner privileges to a Service Principal (SPN)</p><p>Under the Enterprise agreement we have some different Personaâ€™s, which have quite different abilities and operations upon which they are permitted to preform.</p><p>Before we being the process of delegation, It is important to understand this Hierarchy, so we can correctly proceed with the technical work ahead.</p><h1 class="relative text-5xl font-semibold leading-tense text-secondary-500 mb-4 -ml-px" id=enterprise-administrator><a href=#enterprise-administrator class=header-mark aria-label="Header mark for 'Enterprise Administrator'"></a><div id=enterprise-administrator class="absolute -top-28"></div>Enterprise Administrator</h1><p>Has the ability to add additional Enterprise and Department Administrators, Additional this persona can</p></div><div class="flex flex-wrap items-center -ml-2 mb-8"><a href=/tags/identity/ class="flex items-center text-xs uppercase text-primary-500 font-bold m-2"><span class="h-5 w-5 mr-1"><svg class="w-full h-full" fill="none" viewbox="0 0 24 24" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512.0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828.0l-7-7A1.994 1.994.0 013 12V7a4 4 0 014-4z"/></svg> </span>Identity</a></div><div class="flex items-center"><div class="w-16 h-16 overflow-hidden rounded-full shadow-lg"><svg class="icon" viewBox="0 0 496 512"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6.0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7.0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4.0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9s28-2.7 40.9-6.9c2.3-.7 4.7-1.1 7.1-1.1 42.9.0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg>Author</div><div class=ml-4><div class="text-secondary-500 text-lg font-bold">Author: <a href=/ title=Author rel=author class=author>Author</a></div><div class="text-gray-500 text-md font-semibold">Published: <time datetime="24 Apr, 2020">24 Apr, 2020</time></div><div class="text-gray-500 text-md font-semibold">Updated: <time datetime="19 Jul, 2024">19 Jul, 2024</time></div></div></div></div><div class="relative flex-shrink-0 flex-grow max-w-lg min-w-80 pb-8 lg:pb-0 -mt-12 lg:mt-0 transform md:transform-none scale-110 -z-1"><img class="w-full lg:absolute-center drop-shadow-glow" src=./cover-b0769a29.jpg></div></div></div><div id=main class="w-full max-w-screen-2xl mx-auto px-8 lg:px-40 my-24 isolate"><main><div class="grid grid-cols-1 lg:grid-cols-3 gap-x-12 xl:gap-x-24"><div class="lg:col-span-2 copy text-base leading-loose"><p>Delegating Azure Enterprise Agreement Owner privileges to a Service Principal (SPN)</p><p>Under the Enterprise agreement we have some different Personaâ€™s, which have quite different abilities and operations upon which they are permitted to preform.</p><p>Before we being the process of delegation, It is important to understand this Hierarchy, so we can correctly proceed with the technical work ahead.</p><h1 class="relative text-5xl font-semibold leading-tense text-secondary-500 mb-4 -ml-px" id=enterprise-administrator><a href=#enterprise-administrator class=header-mark aria-label="Header mark for 'Enterprise Administrator'"></a><div id=enterprise-administrator class="absolute -top-28"></div>Enterprise Administrator</h1><p>Has the ability to add additional Enterprise and Department Administrators, Additional this persona can</p><ul><li>Add Departments</li><li>Add or Associate Accounts to and Enrolment</li><li>Can view usage and charges across ALL Accounts and Subscriptions</li><li>Can view the monetary commitment balance associated to the Enrolment
There is no limit on the number of Enterprise Administrators that can be associated with an Enrolment, and additionally a notification contact can be assigned to receive all email notifications issued.</li></ul><h2 class="relative text-3xl font-bold leading-tight text-secondary-500 mb-2 mt-12 -ml-px"><div id=department-administrator class="absolute -top-28"></div>Department Administrator</h2><p>The Department Administrator has ability to do the following:</p><ul><li>Create Department Administrator (Department focus â€“ click on add administrator)</li><li>View/Edit Department properties such as name or Cost Center (Department focus â€“ click on edit pen icon)</li><li>Create a new Account Owner on the Department they administer (Switch to Account focus â€“ click on add account)</li><li>Remove the associated Accounts from the Department they administer (In Account focus â€“ hover over account and then select the x icon to delete)</li><li>Download usage details of the Department they administer (Switch to Reports panel on left â€“ Select Download Usage focus)</li><li>View the monthly Usage and Charges associated to their Department if Enterprise Administrator has granted permission to do so. (Switch to Reports panel on left â€“Select Usage Summary focus)</li><li>Enable the Account owners to create Non Production Subscriptions<ul><li>Subscription Offer MS-AZR-0148P for Dev/Test</li><li>Subscription Offer MS-AZR-0017P for Production</li></ul><h2 class="relative text-3xl font-bold leading-tight text-secondary-500 mb-2 mt-12 -ml-px"><div id=account-owners class="absolute -top-28"></div>Account Owners</h2></li></ul><p>The Account Owner can add Subscriptions to their Accounts. Additionally they have the ability to</p><ul><li>Update the Service Administrator for a Subscription</li><li>View Usage Data for their Account</li><li>If enabled by the Enterprise Administrator, can also view Account Charges</li><li>Enumerate existing subscriptions in their account</li><li>Create new subscriptions within the scope of their account
The Account Owner also has the privilegeâ€™s of delegating their responsibility (Role) to a Service Principal; which is the core of the process we are going to undertaken in this post.</li></ul><blockquote class=blockquote style=text-align:right><p>As of March 2020; this is no longer relevant.Â This account is REQUIRED to have established at least on subscription manually.</p></blockquote><p>In theÂ <a href=https://ea.azure.com/ target=_blank rel="noopener noreferrer">EA Portal</a>, theÂ <em>Account</em>Â page for a Department will present a list of established subscription.</p><p><img src=/posts/azure-enterprise-agreement-delegation/img-b0769a29-2020-04-24-ea-01.png alt=Image></p><h1 class="relative text-5xl font-semibold leading-tense text-secondary-500 mb-4 -ml-px" id=programmatic-subscription-creation><a href=#programmatic-subscription-creation class=header-mark aria-label="Header mark for 'Programmatic Subscription Creation'"></a><div id=programmatic-subscription-creation class="absolute -top-28"></div>Programmatic Subscription Creation</h1><p>The objective of the is process is to delegate the EA Account Owner privilegeâ€™s to a Service Principal, which can be leveraged to programmatically establish subscriptions. While the procedure is not overly complex; we will break the operation in 4 key milestones, which should make this easier to understand.</p><ol><li>EA Department Account Owner</li><li>Service Principal for Delegation</li><li>Delegating EA Account Owner Privilegeâ€™s</li><li>Validation</li></ol><h2 class="relative text-3xl font-bold leading-tight text-secondary-500 mb-2 mt-12 -ml-px"><div id=ea-department-account-owner class="absolute -top-28"></div>EA Department Account Owner</h2><p>Using the Azure AD account credentials for your Microsoft Tenant, you should be able to authenticate with theÂ <a href=https://ea.azure.com/ target=_blank rel="noopener noreferrer">EA Portal</a>, and view theÂ <em>Account</em>Â page, as illustrated earlier.</p><p>Once you have confirmed that this works as expected, we will repeat this authentication again, however this time, using either the Azure Powershell Module or the Azure CLI; The guide will present the commands used in either scenario.</p><h3 class="text-xl font-bold text-primary-500 leading-tight mb-2" id=authenticate-to-azure-the-ea-account-owner-credentials><a href=#authenticate-to-azure-the-ea-account-owner-credentials class=header-mark aria-label="Header mark for 'Authenticate to Azure the EA Account Owner Credentials'"></a>Authenticate to Azure the EA Account Owner Credentials</h3><p>With working credentials validated in the EA Web portal, proceed with a new shell session and authenticate to Azure with yourÂ EA Account OwnerÂ credentials; you may also take advantage of the Azure Cloud Shell which will automate the login experience.</p><blockquote class=blockquote style=text-align:right><p>The credentialsÂ MUSTÂ be hosted in the tenants AAD instance. Microsoft Accounts, or Guest accounts from other AAD Tenants are NOT Supported for the following procedures.</p></blockquote><div class="code-block highlight is-open show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>powershell</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-1 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nv>$aadTenantId</span> <span class=p>=</span>      <span class=s2>&#34;aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa&#34;</span> 
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nv>$azSubscriptionId</span> <span class=p>=</span> <span class=s2>&#34;42d96448-0b0a-4b33-9d9a-5653a3f11811&#34;</span> 
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nb>Connect-AzAccount</span> <span class=n>-TenantId</span> <span class=nv>$aadTenantId</span> <span class=n>-Subscription</span> <span class=nv>$azSubscriptionId</span></span></span></code></pre></div><div class="code-block highlight is-open show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>bash</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-2 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl>$&gt; az login</span></span></code></pre></div><h3 class="text-xl font-bold text-primary-500 leading-tight mb-2" id=check-the-ea-accounts-which-we-have-access-to><a href=#check-the-ea-accounts-which-we-have-access-to class=header-mark aria-label="Header mark for 'Check the EA Accounts which we have access to'"></a>Check the EA Accounts which we have access to</h3><p>Once you have authenticated, we will verify that the credentials do indeed have access to the EA environment, but getting a list of the EA Accounts which can be accessed</p><div class="code-block highlight is-open show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>powershell</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-3 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nv>$eaAccountList</span> <span class=p>=</span> <span class=nb>Get-AzEnrollmentAccount</span>
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nv>$eaAccountList</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ObjectId</span>                              <span class=n>PrincipalName</span>
</span></span><span class=line><span class=cl><span class=p>--------</span>                              <span class=p>-------------</span>
</span></span><span class=line><span class=cl><span class=mf>88888888</span><span class=p>-</span><span class=mf>8888</span><span class=p>-</span><span class=mf>8888</span><span class=p>-</span><span class=mf>8888</span><span class=p>-</span><span class=mf>888888888888</span>  <span class=n>eaaccountowner</span><span class=nv>@org</span><span class=p>.</span><span class=py>onmicrosoft</span><span class=p>.</span><span class=py>com</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nv>$EAAccountId</span> <span class=p>=</span> <span class=nv>$eaAccountList</span><span class=p>.</span><span class=n>ObjectId</span></span></span></code></pre></div><div class="code-block highlight is-open show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>bash</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-4 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl>$&gt; az billing enrollment-account list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>
</span></span><span class=line><span class=cl>  <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;/providers/Microsoft.Billing/enrollmentAccounts/88888888-8888-8888-8888-888888888888&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;name&#34;</span>: <span class=s2>&#34;88888888-8888-8888-8888-888888888888&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;principalName&#34;</span>: <span class=s2>&#34;eaaccountowner@org.onmicrosoft.com&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;Microsoft.Billing/enrollmentAccounts&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>]</span></span></span></code></pre></div><p>Assuming the results of these commands, presents back your account, and a billing enrollment object we are ready to proceed. If this is not the case, you must check that you are using the correct account.</p><p>The important data you have as we complete this stage is</p><h2 class="relative text-3xl font-bold leading-tight text-secondary-500 mb-2 mt-12 -ml-px"><div id=service-principal-for-delegation class="absolute -top-28"></div>Service Principal for Delegation</h2><p>Our objective is to delegate the role of creating new Azure Subscriptions to a Service Principal. Before we begin that effort; we first need to know the ObjectID of the (Service Principal) SPN which we are delegating to.</p><h3 class="text-xl font-bold text-primary-500 leading-tight mb-2" id=create-a-new-principal><a href=#create-a-new-principal class=header-mark aria-label="Header mark for 'Create a new principal'"></a>Create a new principal</h3><p>Establish a new AzureAD Application and a Service Principal in the AD Tenant. If you have an existing application which you would rather utilize; we can skip this step and reference that object in the next stage</p><div class="code-block highlight is-open show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>powershell</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-5 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl><span class=nv>$password</span> <span class=p>=</span> <span class=s2>&#34;S3cR3tP@ssw0rd!&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$credentials</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>Microsoft</span><span class=p>.</span><span class=py>Azure</span><span class=p>.</span><span class=py>Commands</span><span class=p>.</span><span class=py>ActiveDirectory</span><span class=p>.</span><span class=py>PSADPasswordCredential</span> <span class=n>-Property</span> <span class=vm>@</span><span class=p>{</span><span class=n>StartDate</span><span class=p>=</span><span class=nb>Get-Date</span><span class=p>;</span> <span class=n>EndDate</span><span class=p>=</span><span class=nb>Get-Date</span> <span class=n>-Year</span> <span class=mf>2024</span><span class=p>;</span> <span class=n>Password</span><span class=p>=</span><span class=nv>$password</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$spName</span> <span class=p>=</span> <span class=s2>&#34;AZ GOV Subscription Provision&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$sp</span> <span class=p>=</span> <span class=nb>New-AzAdServicePrincipal</span> <span class=n>-DisplayName</span> <span class=nv>$spName</span> <span class=n>-PasswordCredential</span> <span class=nv>$credentials</span></span></span></code></pre></div><div class="code-block highlight is-open show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>bash</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-6 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl>Caz ad sp create-for-rbac --name <span class=s2>&#34;azGOVSubscriptionProvision&#34;</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;appId&#34;</span>: <span class=s2>&#34;eeeeeeee-eeee-eeee-eeee-eeeeeeeeeeee&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;displayName&#34;</span>: <span class=s2>&#34;azGOVSubscriptionProvision&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;name&#34;</span>: <span class=s2>&#34;http://azGOVSubscriptionProvision&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;password&#34;</span>: <span class=s2>&#34;8ff3e80e-a518-4dfa-ad5f-235bfb1d8bd9&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;tenant&#34;</span>: <span class=s2>&#34;aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><p>Assuming no errors with this command, you should be able to locate the new principal in the Azure AD portal, under Enterprise Applications.</p><p><img src=/posts/azure-enterprise-agreement-delegation/img-b0769a29-2020-04-24-ea-02.png alt=Image></p><h3 class="text-xl font-bold text-primary-500 leading-tight mb-2" id=get-the-application-id><a href=#get-the-application-id class=header-mark aria-label="Header mark for 'Get the Application ID'"></a>Get the Application ID</h3><p>If you plan on using a newly created Service Principal for the delegation, we can quickly reference it, and store it to a variable</p><div class="code-block highlight is-open show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>powershell</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-7 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nv>$appId</span> <span class=p>=</span> <span class=nv>$sp</span><span class=p>.</span><span class=py>Id</span>
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nv>$appId</span>
</span></span><span class=line><span class=cl><span class=nb>eeeeeeee-eeee</span><span class=n>-eeee-eeee-eeeeeeeeeeee</span></span></span></code></pre></div><p>Alternative, we can reference an existing application, and get its Application Id, in this case we simply provide the display name of the service principal we are going to reference</p><div class="code-block highlight is-open show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>bash</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-8 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl>$&gt; az ad sp list --display-name azGOVSubscriptionProvision --query <span class=s2>&#34;[].objectId&#34;</span> -o tsv
</span></span><span class=line><span class=cl>eeeeeeee-eeee-eeee-eeee-eeeeeeeeeeee</span></span></code></pre></div><h2 class="relative text-3xl font-bold leading-tight text-secondary-500 mb-2 mt-12 -ml-px"><div id=delegating-ea-account-owner-privileges class="absolute -top-28"></div>Delegating EA Account Owner Privilegeâ€™s</h2><p>Finally, we are at the heart of the show. We will delegate the Account Owner role to the chosen Service Principal.</p><h3 class="text-xl font-bold text-primary-500 leading-tight mb-2" id=add-the-service-principal-to-your-enrollment-account><a href=#add-the-service-principal-to-your-enrollment-account class=header-mark aria-label="Header mark for 'Add the service principal to your enrollment account'"></a>Add the service principal to your enrollment account</h3><p>The following command will allocate theÂ OwnerÂ role to the EA Account Id which we discovered earlier, to our chosen Service Principal</p><div class="code-block highlight is-closed show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>powershell</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-9 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nb>New-AzRoleAssignment</span> <span class=n>-ObjectId</span> <span class=nv>$appId</span> <span class=n>-RoleDefinitionName</span> <span class=s2>&#34;Owner&#34;</span> <span class=n>-Scope</span> <span class=s2>&#34;/providers/Microsoft.Billing/enrollmentAccounts/</span><span class=nv>$eaAccountId</span><span class=s2>&#34;</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>RoleAssignmentId</span>   <span class=err>:</span> <span class=p>/</span><span class=n>providers</span><span class=p>/</span><span class=n>Microsoft</span><span class=p>.</span><span class=n>Billing</span><span class=p>/</span><span class=n>enrollmentAccounts</span><span class=p>/</span><span class=mf>88888888</span><span class=p>-</span><span class=mf>8888</span><span class=p>-</span><span class=mf>8888</span><span class=p>-</span><span class=mf>8888</span><span class=p>-</span><span class=mf>888888888888</span><span class=p>/</span><span class=n>providers</span><span class=p>/</span><span class=n>Microsoft</span><span class=p>.</span><span class=n>Authorization</span><span class=p>/</span><span class=n>roleAssignments</span><span class=p>/</span><span class=n>aa516c46</span><span class=p>-</span><span class=mf>1954</span><span class=p>-</span><span class=n>4bac-bddf</span><span class=p>-</span><span class=n>618f1f03acf6</span>
</span></span><span class=line><span class=cl><span class=n>Scope</span>              <span class=err>:</span> <span class=p>/</span><span class=n>providers</span><span class=p>/</span><span class=n>Microsoft</span><span class=p>.</span><span class=n>Billing</span><span class=p>/</span><span class=n>enrollmentAccounts</span><span class=p>/</span><span class=mf>88888888</span><span class=p>-</span><span class=mf>8888</span><span class=p>-</span><span class=mf>8888</span><span class=p>-</span><span class=mf>8888</span><span class=p>-</span><span class=mf>888888888888</span>
</span></span><span class=line><span class=cl><span class=n>DisplayName</span>        <span class=err>:</span> <span class=n>AZ</span> <span class=n>GOV</span> <span class=n>Subscription</span> <span class=n>Provision</span>
</span></span><span class=line><span class=cl><span class=n>SignInName</span>         <span class=err>:</span> 
</span></span><span class=line><span class=cl><span class=n>RoleDefinitionName</span> <span class=err>:</span> <span class=n>Owner</span>
</span></span><span class=line><span class=cl><span class=n>RoleDefinitionId</span>   <span class=err>:</span> <span class=n>8e3af657-a8ff</span><span class=p>-</span><span class=n>443c-a75c</span><span class=p>-</span><span class=n>2fe8c4bcb635</span>
</span></span><span class=line><span class=cl><span class=n>ObjectId</span>           <span class=err>:</span> <span class=nb>eeeeeeee-eeee</span><span class=n>-eeee-eeee-eeeeeeeeeeee</span>
</span></span><span class=line><span class=cl><span class=n>ObjectType</span>         <span class=err>:</span> <span class=n>ServicePrincipal</span>
</span></span><span class=line><span class=cl><span class=n>CanDelegate</span>        <span class=err>:</span> <span class=n>False</span></span></span></code></pre></div><div class="code-block highlight is-closed show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>bash</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-10 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl>$&gt; az role assignment create --role Owner --assignee-object-id eeeeeeee-eeee-eeee-eeee-eeeeeeeeeeee --scope /providers/Microsoft.Billing/enrollmentAccounts/88888888-8888-8888-8888-888888888888
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>   <span class=s2>&#34;canDelegate&#34;</span>: null,
</span></span><span class=line><span class=cl>   <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;/providers/Microsoft.Billing/enrollmentAccounts/88888888-8888-8888-8888-888888888888/providers/Microsoft.Authorization/roleAssignments/11341c1d-7785-46a9-a415-147b5c5aec5c&#34;</span>,
</span></span><span class=line><span class=cl>   <span class=s2>&#34;name&#34;</span>: <span class=s2>&#34;11341c1d-7785-46a9-a415-147b5c5aec5c&#34;</span>,
</span></span><span class=line><span class=cl>   <span class=s2>&#34;principalId&#34;</span>: <span class=s2>&#34;eeeeeeee-eeee-eeee-eeee-eeeeeeeeeeee&#34;</span>,
</span></span><span class=line><span class=cl>   <span class=s2>&#34;roleDefinitionId&#34;</span>: <span class=s2>&#34;/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635&#34;</span>,
</span></span><span class=line><span class=cl>   <span class=s2>&#34;scope&#34;</span>: <span class=s2>&#34;/providers/Microsoft.Billing/enrollmentAccounts/88888888-8888-8888-8888-888888888888&#34;</span>,
</span></span><span class=line><span class=cl>   <span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;Microsoft.Authorization/roleAssignments&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><h3 class="text-xl font-bold text-primary-500 leading-tight mb-2" id=azure-ad-directory-reader><a href=#azure-ad-directory-reader class=header-mark aria-label="Header mark for 'Azure AD Directory Reader'"></a>Azure AD Directory Reader</h3><p>Finally, To ensure the ability of assigning Onwers to the new subscriptions, we MUST also ensure that the Service Principal has the minimum privilegeâ€™s of Azure AD â€˜Directory Readerâ€™ role</p><div class="code-block highlight is-open show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>powershell</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-11 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nb>Connect-AzureAD</span> <span class=n>-TenantId</span> <span class=nb>aaaaaaaa-aaaa</span><span class=n>-aaaa-aaaa-aaaaaaaaaaaa</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Account</span>         <span class=n>Environment</span> <span class=n>TenantId</span>                             <span class=n>TenantDomain</span>             <span class=n>AccountType</span>
</span></span><span class=line><span class=cl><span class=p>-------</span>         <span class=p>-----------</span> <span class=p>--------</span>                             <span class=p>------------</span>             <span class=p>-----------</span>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=nv>@my</span><span class=p>.</span><span class=py>org</span>     <span class=n>AzureCloud</span>  <span class=nb>aaaaaaaa-aaaa</span><span class=n>-aaaa-aaaa-aaaaaaaaaaaa</span> <span class=n>org</span><span class=p>.</span><span class=py>onmicrosoft</span><span class=p>.</span><span class=py>com</span>      <span class=n>User</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nb>Add-AzureADDirectoryRoleMember</span> <span class=n>-ObjectId</span> <span class=p>(</span><span class=nb>Get-AzureADDirectoryRole</span> <span class=p>|</span> <span class=nb>where-object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>DisplayName</span> <span class=o>-eq</span> <span class=s2>&#34;Directory Readers&#34;</span><span class=p>}).</span><span class=py>Objectid</span> <span class=n>-RefObjectId</span> <span class=nv>$appId</span></span></span></code></pre></div><p>Fantastic - now we need to wait for the clock work engine in the back of the cloud to wake up the Noddy. Go have a Coffee, and then we can check the results of our efforts</p><blockquote class=blockquote style=text-align:right><p>These delegations must be allowed to propagate, I have observed this taking up to 1 Hour!</p></blockquote><h2 class="relative text-3xl font-bold leading-tight text-secondary-500 mb-2 mt-12 -ml-px"><div id=validation class="absolute -top-28"></div>Validation</h2><p>The final stage of this effort is to validate that everything is working as desired. After waiting for delegations to propagate, we will authenticate to Azure as our Service Principal, and then attempt to communicate with the services we have granted access to. Ready?</p><h3 class="text-xl font-bold text-primary-500 leading-tight mb-2" id=login-as-your-new-service-principal><a href=#login-as-your-new-service-principal class=header-mark aria-label="Header mark for 'Login as your new Service Principal'"></a>Login as your new Service Principal</h3><p>With a new shell (or an existing on if you wish); we will proceed to login to Azure using the Service Principal Credentials. I assume the service principal has no Azure subscriptions delegated to it; so we will indicate that also at login time, to prevent warning.</p><div class="code-block highlight is-closed show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>powershell</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-12 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl><span class=p>$&gt;</span> <span class=n>az</span> <span class=n>login</span> <span class=p>-</span><span class=n>-service-principal</span> <span class=n>-u</span> <span class=nb>eeeeeeee-eeee</span><span class=n>-eeee-eeee-eeeeeeeeeeee</span> <span class=p>-</span><span class=n>-password</span> <span class=n>Easter2019</span> <span class=p>-</span><span class=n>-tenant</span> <span class=nb>aaaaaaaa-aaaa</span><span class=n>-aaaa-aaaa-aaaaaaaaaaaa</span> <span class=p>-</span><span class=n>-allow-no-subscriptions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;cloudName&#34;</span><span class=err>:</span> <span class=s2>&#34;AzureCloud&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;id&#34;</span><span class=err>:</span> <span class=s2>&#34;369b7bfe-5c66-41ef-837a-e2df4e9db6dd&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;isDefault&#34;</span><span class=err>:</span> <span class=n>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;name&#34;</span><span class=err>:</span> <span class=s2>&#34;Management&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;state&#34;</span><span class=err>:</span> <span class=s2>&#34;Enabled&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;tenantId&#34;</span><span class=err>:</span> <span class=s2>&#34;aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;user&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;name&#34;</span><span class=err>:</span> <span class=s2>&#34;eeeeeeee-eeee-eeee-eeee-eeeeeeeeeeee&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;type&#34;</span><span class=err>:</span> <span class=s2>&#34;servicePrincipal&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span></span></span></code></pre></div><h3 class="text-xl font-bold text-primary-500 leading-tight mb-2" id=check-you-have-directory-access><a href=#check-you-have-directory-access class=header-mark aria-label="Header mark for 'Check you have Directory Access'"></a>Check you have Directory Access</h3><p>First test, lets see if we can read some object from the Azure AD</p><div class="code-block highlight is-open show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>bash</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-13 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl>$&gt; az ad user list</span></span></code></pre></div><p>Assuming no issues, you should see a list of users scroll by, feel free to terminate that process when you are satisfied that this is working to plan</p><h3 class="text-xl font-bold text-primary-500 leading-tight mb-2" id=check-we-have-access-to-the-enterprise-agreement-account><a href=#check-we-have-access-to-the-enterprise-agreement-account class=header-mark aria-label="Header mark for 'Check we have access to the Enterprise Agreement Account'"></a>Check we have access to the Enterprise Agreement Account</h3><p>Now, the real meat; Do we have access to the Enterprise Agreement Account?</p><div class="code-block highlight is-open show-line-numbers tw-group tw-my-2"><div class="code-block-title
tw-flex
tw-flex-row
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><div class="code-block-title-bar tw-w-full"><p class="tw-select-none !tw-my-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>bash</p></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-14 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl>$&gt; az billing enrollment-account list
</span></span><span class=line><span class=cl><span class=o>[</span>
</span></span><span class=line><span class=cl>  <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;/providers/Microsoft.Billing/enrollmentAccounts/88888888-8888-8888-8888-888888888888&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;name&#34;</span>: <span class=s2>&#34;88888888-8888-8888-8888-888888888888&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;principalName&#34;</span>: <span class=s2>&#34;eaaccountowner@org.onmicrosoft.com&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;Microsoft.Billing/enrollmentAccounts&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>]</span></span></span></code></pre></div><p>Assuming you get a response, take a close look at theÂ <em>principalName</em>Â and you will be presented with the name of the account who have delegated their privilegeâ€™s to this active service account to work as.</p><h2 class="relative text-3xl font-bold leading-snug text-secondary-500 mb-2 mt-12 -ml-px"><div id=all-links class=onpage-anchor></div>All links in a practical list</h2><div class="w-full my-6"><a href=https://ea.azure.com/%22 class="break-all flex font-bold hover:text-black underline items-center leading-snug text-primary-500" target=_blank><div class="flex-shrink-0 h-5 w-5 mr-2"><svg class="w-full h-full" viewBox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828.0 1 1 0 00-1.414 1.414 4 4 0 005.656.0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828.0 1 1 0 101.414-1.414 4 4 0 00-5.656.0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"/></svg></div>https://ea.azure.com/"</a></div><div class="w-full my-6"><a href=https://ea.azure.com/%22 class="break-all flex font-bold hover:text-black underline items-center leading-snug text-primary-500" target=_blank><div class="flex-shrink-0 h-5 w-5 mr-2"><svg class="w-full h-full" viewBox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828.0 1 1 0 00-1.414 1.414 4 4 0 005.656.0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828.0 1 1 0 101.414-1.414 4 4 0 00-5.656.0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"/></svg></div>https://ea.azure.com/"</a></div><div class="w-full my-6"><a href=http://azGOVSubscriptionProvision&amp;#34;%3c/span%3e, class="break-all flex font-bold hover:text-black underline items-center leading-snug text-primary-500" target=_blank><div class="flex-shrink-0 h-5 w-5 mr-2"><svg class="w-full h-full" viewBox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828.0 1 1 0 00-1.414 1.414 4 4 0 005.656.0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828.0 1 1 0 101.414-1.414 4 4 0 00-5.656.0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"/></svg></div>http://azGOVSubscriptionProvision"</span>,</a></div></div><aside class="order-first lg:order-last lg:pt-12"><div class="lg:sticky lg:top-24 overflow-y-auto" x-data=taToc data-length=197 data-threshold=400 data-elements=6 data-title-show data-title-hide><h2 class="relative text-3xl lg:text-xl font-bold leading-tight text-secondary-500">Table of contents</h2><div class="tableofcontents pt-4 px-1"><nav id=TableOfContents><ul><li><a href=#department-administrator>Department Administrator</a></li><li><a href=#account-owners>Account Owners</a></li></ul><ul><li><a href=#ea-department-account-owner>EA Department Account Owner</a><ul><li><a href=#authenticate-to-azure-the-ea-account-owner-credentials>Authenticate to Azure the EA Account Owner Credentials</a></li><li><a href=#check-the-ea-accounts-which-we-have-access-to>Check the EA Accounts which we have access to</a></li></ul></li><li><a href=#service-principal-for-delegation>Service Principal for Delegation</a><ul><li><a href=#create-a-new-principal>Create a new principal</a></li><li><a href=#get-the-application-id>Get the Application ID</a></li></ul></li><li><a href=#delegating-ea-account-owner-privileges>Delegating EA Account Owner Privilegeâ€™s</a><ul><li><a href=#add-the-service-principal-to-your-enrollment-account>Add the service principal to your enrollment account</a></li><li><a href=#azure-ad-directory-reader>Azure AD Directory Reader</a></li></ul></li><li><a href=#validation>Validation</a><ul><li><a href=#login-as-your-new-service-principal>Login as your new Service Principal</a></li><li><a href=#check-you-have-directory-access>Check you have Directory Access</a></li><li><a href=#check-we-have-access-to-the-enterprise-agreement-account>Check we have access to the Enterprise Agreement Account</a></li></ul></li></ul></nav></div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script></div></aside></div></main></div></main><footer role=footer><div class="relative w-full bg-gray-100 bg-gradient-to-b from-gray-200 to-white pt-20"><div class="absolute inset-x-0 top-0 w-full h-40 text-white"><svg class="w-full" viewbox="0 0 1680 91" fill="currentcolor" preserveaspectratio="none"><path d="M1680 0H0L.324249e-4 61.9736C60.8062 60.5012 108.186 53.8676 158.825 46.7777 211.452 39.4093 267.601 31.548 346 28.4749c62.978-2.4687 133.888 5.1285 211.598 13.4542C669.71 53.9406 795.977 67.4685 933 54.4749c232-22 509 7.4989 747 35.9962V0z"/></svg></div><div class="flex justify-between w-full max-w-screen-2xl mx-auto px-8 lg:px-40 pb-16 pt-8"><div class="flex-shrink-0 w-2/12 sm:w-1/12"><img src=/images/img-logo-damian-flynn-blue.svg alt class=w-full></div><div class="flex-grow flex flex-wrap justify-between text-secondary-500 ml-8 pt-4"><div class="w-full sm:w-5/12 pb-8 sm:pb-2"><p class="text-base font-bold mb-2">Let me introduce myself</p><p class="text-sm text-gray-500 font-regular">I am a Microsoft Microsoft MVP with over 20 years of experience in making technology simpler through Infrastructure as Code (IaC) and cloud operations. Iâ€™m passionate about transforming complex Azure environments into intuitive systems, starting with a minimal viable product that delivers real value. My goal is to enhance user experience while empowering teams to grow and succeed in the cloud landscape.</p></div><div class="flex-shrink-0 w-4/12 sm:w-2/12 pb-2"><p class="text-base font-bold mb-2">Links</p><p class="text-sm leading-tight font-bold"><a href=/about class="inline-block text-primary-500 font-semibold hover:text-black hover:underline mb-1 mr-2">About</a>
<a href=/posts class="inline-block text-primary-500 font-semibold hover:text-black hover:underline mb-1 mr-2">Articles</a>
<a href=/contact.html class="inline-block text-primary-500 font-semibold hover:text-black hover:underline mb-1 mr-2">Contact</a>
<a href=/work.html class="inline-block text-primary-500 font-semibold hover:text-black hover:underline mb-1 mr-2">Work</a>
<a href=/disclaimer class="inline-block text-primary-500 font-semibold hover:text-black hover:underline mb-1 mr-2">Imprint</a>
<a href=/privacy class="inline-block text-primary-500 font-semibold hover:text-black hover:underline mb-1 mr-2">Privacy</a></p></div><div class="flex-shrink-0 w-6/12 sm:w-4/12 pb-2"><p class="text-base font-bold mb-2">Various topics</p><p class="text-sm leading-tight font-bold"><a href=/series/building-azure-with-code class="block text-primary-500 font-semibold hover:text-black hover:underline mb-1">Building Azure with Code</a>
<a href=/series/ignite-2019 class="block text-primary-500 font-semibold hover:text-black hover:underline mb-1">Ignite 2019</a>
<a href=/series/azure-iot-operations class="block text-primary-500 font-semibold hover:text-black hover:underline mb-1">Azure IoT Operations</a></p></div></div></div><div class="absolute inset-x-0 -bottom-2 text-secondary-500"><svg class="w-full h-12" fill="currentcolor" viewbox="0 0 1680 52" preserveaspectratio="none"><path d="m419 21.2305c-194 0-295-15.23306-418.99999624-12.2305l4298e-8 43L1680 51.9981V41.2042c-80-11.9737-348-48.3153-542-39.97374S613 21.2305 419 21.2305z"/></svg></div></div><div class="relative bg-secondary-500 text-xs font-semibold text-center text-secondary-50"><div class="w-full max-w-screen-2xl mx-auto px-8 lg:px-40 pb-6 pt-2"><p><svg class="icon" viewBox="0 0 512 512"><path d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 448c-110.532.0-2e2-89.451-2e2-2e2.0-110.531 89.451-2e2 2e2-2e2 110.532.0 2e2 89.451 2e2 2e2.0 110.532-89.451 2e2-2e2 2e2zm107.351-101.064c-9.614 9.712-45.53 41.396-104.065 41.396-82.43.0-140.484-61.425-140.484-141.567.0-79.152 60.275-139.401 139.762-139.401 55.531.0 88.738 26.62 97.593 34.779a11.965 11.965.0 011.936 15.322l-18.155 28.113c-3.841 5.95-11.966 7.282-17.499 2.921-8.595-6.776-31.814-22.538-61.708-22.538-48.303.0-77.916 35.33-77.916 80.082.0 41.589 26.888 83.692 78.277 83.692 32.657.0 56.843-19.039 65.726-27.225 5.27-4.857 13.596-4.039 17.82 1.738l19.865 27.17a11.947 11.947.0 01-1.152 15.518z"/></svg>2011 - 2026<a href=/ target=_blank rel="noopener noreferrer"> </a>&nbsp;|&nbsp;<a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></p><div class="flex items-center justify-center my-2"><a href=https://www.youtube.com/channel/UCC-9OqE4nfLxDf-TonKqIRw/ class="font-extrabold text-white mx-2" title="Opens in new Window">Youtube </a><a href=https://github.com/damianflynn class="font-extrabold text-white mx-2" target=_blank title="Opens in new Window">GitHub </a><a href=https://www.x.com/damian_flynn class="font-extrabold text-white mx-2" target=_blank title="Opens in new Window">X </a><a href=https://www.linkedin.com/in/damianflynn class="font-extrabold text-white mx-2" target=_blank title="Opens in new Window">Linkedin</a></div><p></p></div></div></footer><script src=/js/js-scripts.js></script><script type=speculationrules>
        {
          "prerender": [
            {
              "where": { "href_matches": "/*" },
              "eagerness": "moderate"
            }
          ]
        }
    </script><script>console.log(`Page Title: Azure Enterprise Agreement Delegation
Page URL: https://damianflynn.github.io/posts/azure-enterprise-agreement-delegation/
Page Type: posts`)</script></body></html>